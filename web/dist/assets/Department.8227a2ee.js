import{f as j,p as x}from"./api.ae6dea3f.js";import{r as s,m as Y,b as p,c as Z,o as u,j as g,f as a,e as t,F as b,i as w,l as V,g as c,w as ee,d as C,E as _}from"./index.a78e2dbf.js";const le={class:"grid-content ep-bg-purple-dark"},ae={class:"grid-content ep-bg-purple-dark"},te={class:"grid-content ep-bg-purple-dark"},oe=w("div",{style:{"margin-top":"40px"}},null,-1),ne=w("div",{style:{"margin-top":"20px"}},null,-1),de={class:"dialog-footer"},ue={class:"dialog-footer"},ie={__name:"Department",setup(re){const W=s(!1),k=s({}),U=s([]),T=s([]),h=s(""),M=s(""),L=s(""),B=s(10),z=[10,20,30,50],$=s(!1),D=s(!1),o=s({id:"",deptCode:"",deptName:"",deptCategoryID:"",deptCategoryName:"",deptType:""}),E=s({deptCode:[{required:!0,message:"\u8BF7\u8F93\u5165\u79D1\u5BA4\u7F16\u7801",trigger:"blur"}],deptName:[{required:!0,message:"\u8BF7\u8F93\u5165\u79D1\u5BA4\u540D\u79F0",trigger:"blur"}]});Y(async()=>{i(1),q(1,1e3,U),q(12,1e3,T)});async function q(n,l,d){let m=`/constantitem/page?ctype=${n}&count=${l}&pn=1`;const r=await j(m,null);r.result?d.value=r.data.records:r.errMsg=="\u672A\u767B\u5F55"&&router.push("/login")}async function i(n){W.value=!0;let l=`/department/page?count=${B.value}&pn=${n}`;h!=""&&(l+=`&keyword=${h.value}`),M!=""&&(l+=`&ctype=${M.value}`),L!=""&&(l+=`&dtype=${L.value}`);const d=await j(l,null);d.result?(k.value=d.data,W.value=!1):d.errMsg=="\u672A\u767B\u5F55"&&router.push("/login")}function K(n){i(n)}function R(n){D.value=!0,o.value=n}function F(){o.value={id:"",deptCode:"",deptName:"",deptCategoryID:"",deptCategoryName:"",deptType:""}}function A(){console.log(o.value.deptType),x("/department/update",o.value).then(n=>{n.data.result?(D.value=!1,i(k.value.current),_.alert("\u4FEE\u6539\u6210\u529F","\u63D0\u793A",{})):(result.errMsg=="\u672A\u767B\u5F55"&&router.push("/login"),_.alert(n.data.errMsg,"\u63D0\u793A",{}))})}function G(){x("/department/add",o.value).then(n=>{n.data.result?($.value=!1,_.alert("\u65B0\u589E\u6210\u529F","\u63D0\u793A",{})):(result.errMsg=="\u672A\u767B\u5F55"&&router.push("/login"),_.alert(n.data.errMsg,"\u63D0\u793A",{}))})}function H(n){_.confirm("\u786E\u8BA4\u662F\u5426\u5220\u9664?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(()=>{var l=new FormData;l.append("id",n),x("/department/del",l).then(d=>{d.data.result?(i(k.value.current),_.alert("\u5220\u9664\u6210\u529F","\u63D0\u793A",{})):(result.errMsg=="\u672A\u767B\u5F55"&&router.push("/login"),_.alert(d.data.errMsg,"\u63D0\u793A",{}))})})}return(n,l)=>{const d=p("el-option"),m=p("el-select"),r=p("el-col"),y=p("el-input"),f=p("el-button"),I=p("el-row"),N=p("el-table-column"),J=p("el-table"),P=p("el-pagination"),v=p("el-form-item"),O=p("el-form"),S=p("el-dialog"),Q=Z("loading");return u(),g(b,null,[a(I,null,{default:t(()=>[a(r,{span:5},{default:t(()=>[w("div",le,[a(m,{modelValue:L.value,"onUpdate:modelValue":l[0]||(l[0]=e=>L.value=e),class:"m-2",filterable:"",clearable:"",onClear:l[1]||(l[1]=e=>i(1)),placeholder:"\u79D1\u5BA4\u7C7B\u578B",onChange:l[2]||(l[2]=e=>i(1))},{default:t(()=>[(u(!0),g(b,null,V(T.value,e=>(u(),C(d,{key:e.id,label:e.constantCode+e.constantName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),a(r,{span:5},{default:t(()=>[w("div",ae,[a(m,{modelValue:M.value,"onUpdate:modelValue":l[3]||(l[3]=e=>M.value=e),class:"m-2",filterable:"",clearable:"",onClear:l[4]||(l[4]=e=>i(1)),placeholder:"\u79D1\u5BA4\u5206\u7C7B",onChange:l[5]||(l[5]=e=>i(1))},{default:t(()=>[(u(!0),g(b,null,V(U.value,e=>(u(),C(d,{key:e.id,label:e.constantCode+e.constantName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),a(r,{span:5},{default:t(()=>[w("div",te,[a(y,{modelValue:h.value,"onUpdate:modelValue":l[6]||(l[6]=e=>h.value=e),modelModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165\u5E38\u6570\u9879\u7F16\u7801\u6216\u540D\u79F0",class:"w-100 m-2"},null,8,["modelValue"])])]),_:1}),a(r,{span:1}),a(r,{span:4,class:"m-2"},{default:t(()=>[a(f,{type:"primary",onClick:l[7]||(l[7]=e=>i(1))},{default:t(()=>[c("\u67E5\u8BE2")]),_:1})]),_:1}),a(r,{span:4},{default:t(()=>[a(f,{type:"danger",onClick:l[8]||(l[8]=e=>$.value=!0)},{default:t(()=>[c("\u65B0\u589E\u79D1\u5BA4")]),_:1})]),_:1})]),_:1}),oe,a(I,{class:"m-2"},{default:t(()=>[a(r,{span:24},{default:t(()=>[ee((u(),C(J,{data:k.value.records,style:{width:"100%"}},{default:t(()=>[a(N,{fixed:"",prop:"id",label:"\u5E8F\u53F7",width:"80",align:"center"}),a(N,{prop:"deptCode",label:"\u79D1\u5BA4\u7F16\u7801",align:"center"}),a(N,{prop:"deptName",label:"\u79D1\u5BA4\u540D\u79F0",align:"center"}),a(N,{prop:"deptCategoryName",label:"\u79D1\u5BA4\u5206\u7C7B",align:"center"}),a(N,{prop:"deptTypeName",label:"\u79D1\u5BA4\u7C7B\u578B",align:"center"}),a(N,{fixed:"right",label:"Operations",align:"center"},{default:t(e=>[a(f,{link:"",type:"primary",onClick:X=>R(e.row)},{default:t(()=>[c("\u7F16\u8F91")]),_:2},1032,["onClick"]),a(f,{link:"",type:"danger",onClick:X=>H(e.row.id)},{default:t(()=>[c("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,W.value]])]),_:1})]),_:1}),ne,a(I,null,{default:t(()=>[a(r,{span:20},{default:t(()=>[a(P,{background:"",layout:"prev, pager, next",total:k.value.total,"page-count":k.value.pages,onCurrentChange:K},null,8,["total","page-count"])]),_:1}),a(r,{span:4},{default:t(()=>[a(m,{modelValue:B.value,"onUpdate:modelValue":l[9]||(l[9]=e=>B.value=e),class:"m-2",placeholder:"\u6BCF\u9875\u884C\u6570",onChange:l[10]||(l[10]=e=>i(1))},{default:t(()=>[(u(),g(b,null,V(z,e=>a(d,{key:e,label:e,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(S,{modelValue:D.value,"onUpdate:modelValue":l[17]||(l[17]=e=>D.value=e),title:"\u7F16\u8F91",onClose:F},{footer:t(()=>[w("span",de,[a(f,{onClick:l[16]||(l[16]=e=>D.value=!1)},{default:t(()=>[c("\u53D6\u6D88")]),_:1}),a(f,{type:"primary",onClick:A},{default:t(()=>[c(" \u4FDD\u5B58 ")]),_:1})])]),default:t(()=>[a(O,{model:o.value,rules:E.value},{default:t(()=>[a(v,{label:"\u7F16\u53F7","label-width":n.formLabelWidth,prop:"id"},{default:t(()=>[a(y,{modelValue:o.value.id,"onUpdate:modelValue":l[11]||(l[11]=e=>o.value.id=e),readonly:"",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(v,{label:"\u79D1\u5BA4\u7C7B\u578B","label-width":n.formLabelWidth,prop:"constantTypeCode"},{default:t(()=>[a(m,{modelValue:o.value.deptType,"onUpdate:modelValue":l[12]||(l[12]=e=>o.value.deptType=e),class:"m-2",filterable:"",placeholder:"\u79D1\u5BA4\u7C7B\u578B"},{default:t(()=>[(u(!0),g(b,null,V(T.value,e=>(u(),C(d,{key:e.id,label:e.constantCode+e.constantName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(m,{modelValue:o.value.deptCategoryID,"onUpdate:modelValue":l[13]||(l[13]=e=>o.value.deptCategoryID=e),class:"m-2",filterable:"",placeholder:"\u79D1\u5BA4\u5206\u7C7B"},{default:t(()=>[(u(!0),g(b,null,V(U.value,e=>(u(),C(d,{key:e.id,label:e.constantCode+e.constantName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),a(v,{label:"\u79D1\u5BA4\u7F16\u7801","label-width":n.formLabelWidth,prop:"id"},{default:t(()=>[a(y,{modelValue:o.value.deptCode,"onUpdate:modelValue":l[14]||(l[14]=e=>o.value.deptCode=e),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(v,{label:"\u79D1\u5BA4\u540D\u79F0","label-width":n.formLabelWidth,prop:"id"},{default:t(()=>[a(y,{modelValue:o.value.deptName,"onUpdate:modelValue":l[15]||(l[15]=e=>o.value.deptName=e),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),a(S,{modelValue:$.value,"onUpdate:modelValue":l[24]||(l[24]=e=>$.value=e),title:"\u65B0\u589E",onClose:F},{footer:t(()=>[w("span",ue,[a(f,{onClick:l[23]||(l[23]=e=>$.value=!1)},{default:t(()=>[c("\u53D6\u6D88")]),_:1}),a(f,{type:"primary",onClick:G},{default:t(()=>[c(" \u65B0\u589E ")]),_:1})])]),default:t(()=>[a(O,{model:o.value,rules:E.value},{default:t(()=>[a(v,{label:"\u7F16\u53F7","label-width":n.formLabelWidth,prop:"id"},{default:t(()=>[a(y,{modelValue:o.value.id,"onUpdate:modelValue":l[18]||(l[18]=e=>o.value.id=e),readonly:"",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(v,{label:"\u79D1\u5BA4\u7C7B\u578B","label-width":n.formLabelWidth,prop:"constantTypeCode"},{default:t(()=>[a(m,{modelValue:o.value.deptType,"onUpdate:modelValue":l[19]||(l[19]=e=>o.value.deptType=e),class:"m-2",filterable:"",placeholder:"\u79D1\u5BA4\u7C7B\u578B"},{default:t(()=>[(u(!0),g(b,null,V(T.value,e=>(u(),C(d,{key:e.id,label:e.constantCode+e.constantName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(m,{modelValue:o.value.deptCategoryID,"onUpdate:modelValue":l[20]||(l[20]=e=>o.value.deptCategoryID=e),class:"m-2",filterable:"",placeholder:"\u79D1\u5BA4\u5206\u7C7B"},{default:t(()=>[(u(!0),g(b,null,V(U.value,e=>(u(),C(d,{key:e.id,label:e.constantCode+e.constantName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label-width"]),a(v,{label:"\u79D1\u5BA4\u7F16\u7801","label-width":n.formLabelWidth,prop:"id"},{default:t(()=>[a(y,{modelValue:o.value.deptCode,"onUpdate:modelValue":l[21]||(l[21]=e=>o.value.deptCode=e),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(v,{label:"\u79D1\u5BA4\u540D\u79F0","label-width":n.formLabelWidth,prop:"id"},{default:t(()=>[a(y,{modelValue:o.value.deptName,"onUpdate:modelValue":l[22]||(l[22]=e=>o.value.deptName=e),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}};export{ie as default};
